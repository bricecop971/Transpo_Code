<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Transpose AI</title>
    <link rel="stylesheet" href="style.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/abcjs/6.2.2/abcjs-basic-min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/abcjs/6.2.2/abcjs-audio.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script>pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        /* Style Rapide pour le Dashboard (Surcharg√© dans style.css normalement) */
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin: 20px auto;
            width: 80%;
            display: none; /* Cach√© au d√©but */
        }
        .dash-card {
            background: #222;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #444;
            text-align: left;
        }
        .dash-card label { display: block; font-size: 12px; color: #888; margin-bottom: 5px;}
        .dash-card input { width: 100%; background: transparent; border: none; color: #fff; font-weight: bold; font-size: 16px;}
        
        .abc-editor {
            width: 80%;
            height: 100px;
            background: #111;
            color: #0f0;
            font-family: monospace;
            margin: 0 auto;
            display: none; /* On le cache, l'utilisateur normal n'a pas besoin de le voir */
        }
        
        .toggle-code {
            color: #555;
            font-size: 12px;
            cursor: pointer;
            margin-top: 5px;
            text-decoration: underline;
        }
    </style>
</head>
<body>

    <header>
        <h1>Smart Transpose AI</h1>
        <p>L'IA au service de votre instrument</p>
    </header>

    <main>
        <div class="upload-zone">
            <p>üì∏ D√©posez une partition (PDF ou Image)</p>
            <input type="file" id="partition-upload" accept="image/*,.pdf">
        </div>

        <div id="music-dashboard" class="dashboard">
            <div class="dash-card">
                <label>TITRE</label>
                <input type="text" id="meta-title" placeholder="Inconnu">
            </div>
            <div class="dash-card">
                <label>SIGNATURE (MESURE)</label>
                <input type="text" id="meta-meter" placeholder="ex: 4/4">
            </div>
            <div class="dash-card">
                <label>TONALIT√â ORIGINALE</label>
                <input type="text" id="meta-key" placeholder="ex: C (Do Maj)">
            </div>
        </div>

        <div style="text-align: center;">
            <span class="toggle-code" onclick="toggleEditor()">Afficher/Masquer le code brut (Expert)</span>
            <textarea id="notes-input" class="abc-editor"></textarea>
        </div>

        <div class="options-container">
            <label for="transposition">Vers quel instrument ?</label>
            <select id="transposition">
                <option value="Eb">Saxophone Alto (Mi b√©mol)</option>
                <option value="Bb">Trompette / Clarinette (Si b√©mol)</option>
                <option value="F">Cor (Fa)</option>
                <option value="C" selected>Piano / Fl√ªte (Pas de changement)</option>
            </select>
        </div>

        <button id="transpose-btn">‚ú® Transposer la Partition</button>

        <div id="result-zone" class="result-hidden">
            <h2>R√©sultat</h2>
            <p>Transpos√© pour : <strong id="instrument-display">...</strong></p>
            
            <div id="audio" class="abcjs-large"></div>
            <div id="paper"></div>

            <a href="#" id="print-btn" class="download-btn">üñ®Ô∏è Imprimer / PDF</a>
            <button id="reset-btn" class="secondary-btn">üîÑ Recommencer</button>
        </div>
    </main>

    <footer>
        <p>Technologie Gemini AI + Vercel</p>
    </footer>

    <script src="script.js"></script>
    <script>
        function toggleEditor() {
            const el = document.getElementById('notes-input');
            el.style.display = el.style.display === 'block' ? 'none' : 'block';
        }
    </script>
</body>
</html>
