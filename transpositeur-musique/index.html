<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transpositeur IA</title>
    <link rel="stylesheet" href="style.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/abcjs/6.2.2/abcjs-basic-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script>pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';</script>

    <style>
        /* CORRECTIF VISUEL OBLIGATOIRE */
        body { background-color: #121212; color: #e0e0e0; font-family: sans-serif; text-align: center; }
        
        /* 1. La feuille de partition DOIT √™tre blanche */
        #paper {
            background-color: white !important;
            color: black !important;
            padding: 15px;
            margin: 20px auto;
            width: 90%;
            border-radius: 5px;
            overflow-x: auto;
        }
        #paper svg { width: 100% !important; }
        /* Force la couleur noire pour l'impression et l'√©cran */
        #paper svg path { fill: #000000 !important; stroke: #000000 !important; }

        /* 2. Les boutons DOIVENT √™tre lisibles */
        button {
            background-color: #333;
            color: white;
            border: 1px solid #555;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        button:hover { background-color: #555; }
        
        /* Le bouton principal */
        #transpose-btn {
            background-color: #00e5ff;
            color: #000; /* Texte noir sur bleu */
            border: none;
            font-weight: bold;
            font-size: 16px;
            padding: 15px 30px;
            margin-top: 20px;
        }

        /* 3. Dashboard lisible */
        .dash-card { background: #222; border: 1px solid #444; padding: 10px; border-radius: 8px; text-align: left; }
        .dash-card label { display: block; font-size: 11px; color: #aaa; margin-bottom: 5px; }
        .dash-card input { width: 100%; background: transparent; border: none; color: #00e5ff; font-weight: bold; font-size: 16px; outline: none; }
        
        /* 4. Lecteur Audio */
        .abcjs-inline-audio { background: #222; border: 1px solid #00e5ff; border-radius: 5px; padding: 5px; margin-top: 10px; display: flex; justify-content: center; }
        .abcjs-btn { background: #00e5ff !important; color: black !important; padding: 2px 8px; border-radius: 3px; border: none; margin: 0 2px; }
        .abcjs-midi-progress-background { background: #444; border: 1px solid #555; }
        .abcjs-midi-progress-indicator { background: #00e5ff; }
    </style>
</head>
<body>

    <header><h1>üéº Transpositeur IA</h1></header>

    <main>
        <div class="upload-zone" style="border: 2px dashed #00e5ff; padding: 30px; margin: 20px auto; width: 80%; background: rgba(0,229,255,0.05);">
            <p id="upload-text">üì∏ Chargez votre partition</p>
            <input type="file" id="partition-upload" accept="image/*,.pdf">
        </div>

        <div id="dashboard" style="display:none; margin: 20px auto; width: 80%;">
            <div style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap:10px;">
                <div class="dash-card"><label>TITRE</label><input type="text" id="meta-title"></div>
                <div class="dash-card"><label>MESURE</label><input type="text" id="meta-meter"></div>
                <div class="dash-card"><label>TONALIT√â</label><input type="text" id="meta-key"></div>
            </div>
            <textarea id="abc-source" style="display:none;"></textarea>
        </div>

        <div class="options-container" style="margin: 20px;">
            <label>Transposer vers : </label>
            <select id="transposition" style="padding:10px; border-radius:5px; background:#333; color:white;">
                <option value="Eb">Saxophone Alto (Mi b√©mol)</option>
                <option value="Bb">Trompette (Si b√©mol)</option>
                <option value="F">Cor (Fa)</option>
                <option value="C" selected>Piano / Fl√ªte</option>
            </select>
        </div>

        <button id="transpose-btn">‚ú® Transposer</button>

        <div id="result-zone" style="display:none; margin-top:30px;">
            <h2 id="final-title">R√©sultat</h2>
            <div id="audio"></div>
            <div id="paper"></div>
            <button onclick="window.print()">üñ®Ô∏è Imprimer</button>
            <button onclick="window.location.reload()">üîÑ Nouveau</button>
        </div>
    </main>

    <script src="script.js"></script>
</body>
</html>
